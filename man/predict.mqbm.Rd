% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict.mqbm.R
\name{predict.mqbm}
\alias{predict.mqbm}
\title{Predict quantiles from a multiplexed mqbm model}
\usage{
\method{predict}{mqbm}(
  object,
  newdata,
  multiplexer = NULL,
  type = c("surface", "quantile"),
  ...
)
}
\arguments{
\item{object}{A fitted mqbm model object returned by \code{\link{mqbm}}.}

\item{newdata}{A data.frame or matrix of predictor variables. Must either
contain a column with the name specified by \code{object$multiplexer}
identifying which model to use for each observation, or \code{multiplexer} must be provided
as a separate argument.}

\item{multiplexer}{Optional character vector specifying which group-specific model
to use for each row of \code{newdata}. If \code{NULL} (default), the
function looks for a column named \code{object$multiplexer} in \code{newdata}.
Must contain only groups that were present in the training data.}

\item{type}{Character string specifying the type of prediction. Either \code{"surface"}
for raw quantile predictions (default) or \code{"quantile"} for ECDF-transformed
probabilities.}

\item{...}{Additional arguments (currently unused).}
}
\value{
A numeric vector of length \code{nrow(newdata)} containing predictions.
If \code{type = "surface"}, returns raw quantile values from the group-specific
models. If \code{type = "quantile"}, returns ECDF-transformed probabilities (0-1 range)
representing the empirical percentile within each group's training distribution.
}
\description{
Routes predictions to the appropriate group-specific \code{\link{qbm}} model
based on the group identifier for each observation. Each raw prediction from the
quantile regression model is transformed through the group-specific empirical
cumulative distribution function (ECDF) to return probabilities instead of raw values.
}
\details{
The prediction process:
\enumerate{
\item Extract or validate group identifiers for each observation
\item Verify all groups exist in the trained models
\item Route each observation to its group-specific \code{\link{qbm}} model
\item Transform raw predictions through group-specific ECDF to get probabilities
\item Combine predictions maintaining original row order
}

Groups in \code{newdata} must match those used during training. Unknown
groups will trigger an error with a list of available groups.
}
\examples{
\dontrun{
# Train multi-group model
df <- data.frame(
  x1 = rnorm(200),
  x2 = rnorm(200),
  cluster = sample(c("A", "B", "C"), 200, replace = TRUE)
)
df$y <- df$x1 * 0.5 + rnorm(200)
fit <- mqbm(y ~ x1 + x2, data = df, multiplexer = "cluster", tau = 0.5, nrounds = 50)

# Method 1: Group in newdata
newdata_with_group <- data.frame(
  x1 = c(0, 1, -1),
  x2 = c(0, 0, 1),
  cluster = c("A", "B", "A")
)
predict(fit, newdata_with_group)

# Method 2: Group as separate argument
newdata_no_group <- data.frame(
  x1 = c(0, 1, -1),
  x2 = c(0, 0, 1)
)
groups <- c("A", "B", "C")
predict(fit, newdata_no_group, multiplexer = groups)

# Predictions automatically use correct group-specific model
# Each row gets prediction from its designated group model
}

}
\seealso{
\code{\link{mqbm}}, \code{\link{predict.qbm}}, \code{\link{fitted.mqbm}},
\code{\link{residuals.mqbm}}
}
